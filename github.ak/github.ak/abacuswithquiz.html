
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Interactive Abacus</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
      body {
        font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif;
        background: linear-gradient(135deg, #e8f0f7, #d4e4f0);
        min-height: 100vh;
        padding: 10px 10px 90px 10px;
      }

      .abacus-container {
        padding: 10px 20px;
        position: relative;
      }

      .abacus {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin: 0 auto;
        flex-wrap: wrap;
        max-width: 100%;
      }

      .rod-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        flex: 0 0 auto;
      }

      .rod-label {
        display: none;
      }

      .rod {
        position: relative;
        background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%);
        border: 2px solid #dee2e6;
        border-radius: 18px;
        width: 90px;
        height: 400px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12),
          inset 0 2px 4px rgba(255, 255, 255, 0.8),
          inset 0 -2px 4px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        transition: transform 0.3s, box-shadow 0.3s;
        padding-top: 40px;
      }

      .rod:hover {
        transform: translateY(-4px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
      }

      .rod.overflow {
        transform: scale(1.05);
        box-shadow: 0 0 20px rgba(255, 0, 0, 0.5);
      }

      .rod-inner-label {
        position: absolute;
        top: 8px;
        left: 50%;
        transform: translateX(-50%);
        width: 88%;
        padding: 6px 4px;
        font-weight: 700;
        font-size: 0.6rem;
        color: #fff;
        text-align: center;
        border-radius: 8px;
        text-transform: uppercase;
        letter-spacing: 0.2px;
        z-index: 10;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        line-height: 1.1;
        word-wrap: break-word;
      }

      .bead {
        position: absolute;
        left: 50%;
        width: 38px;
        height: 38px;
        margin-left: -19px;
        border-radius: 50%;
        border: 2px solid rgba(0, 0, 0, 0.15);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2),
          inset 0 2px 6px rgba(255, 255, 255, 0.6),
          inset 0 -2px 4px rgba(0, 0, 0, 0.15);
        top: -55px;
        transition: top 0.6s ease-out;
      }

      .clear-button-container {
        display: flex;
        justify-content: center;
        margin: 20px 0 15px 0;
      }

      .clear-button {
        padding: 10px 30px;
        background: linear-gradient(135deg, #dc3545, #c82333);
        color: white;
        border: none;
        border-radius: 12px;
        font-size: 1rem;
        font-weight: 700;
        cursor: pointer;
        box-shadow: 0 6px 12px rgba(220, 53, 69, 0.4);
        transition: all 0.3s;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .clear-button:hover {
        background: linear-gradient(135deg, #c82333, #bd2130);
        transform: translateY(-3px);
        box-shadow: 0 10px 20px rgba(220, 53, 69, 0.5);
      }

      .current-value-display {
        background: #fff;
        border-radius: 16px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
        padding: 20px;
        max-width: 550px;
        text-align: center;
        margin: 15px auto;
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
        transition: opacity 0.4s, visibility 0.4s;
      }

      .current-value-display.visible {
        opacity: 1;
        visibility: visible;
      }

      .current-value-display .value-label {
        font-size: 0.9rem;
        color: #4a5568;
        font-weight: 700;
        margin-bottom: 10px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .current-value-display .value-number {
        font-size: 2.5rem;
        font-weight: 700;
        color: #2563eb;
        margin-bottom: 15px;
        letter-spacing: 1px;
      }

      .current-value-display .value-words {
        font-size: 1.1rem;
        color: #64748b;
        font-weight: 500;
        line-height: 1.4;
      }

      .quiz-section {
        background: #fff;
        border-radius: 16px;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        padding: 40px;
        margin: 20px auto;
        max-width: 900px;
      }

      .quiz-question {
        font-size: 1.5rem;
        color: #2b6cb0;
        font-weight: 600;
        margin-bottom: 30px;
        text-align: center;
      }

      #quizOptionsContainer {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
        max-width: 800px;
        margin: 0 auto;
      }

      .quiz-option {
        padding: 30px 20px;
        background: #f8f9fa;
        border: 3px solid #dee2e6;
        border-radius: 12px;
        cursor: pointer;
        font-size: 1.5rem;
        font-weight: 600;
        color: #2c5282;
        transition: all 0.3s;
        text-align: center;
      }

      .quiz-option:hover:not(.disabled) {
        background: #e9ecef;
        border-color: #2b6cb0;
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
      }

      .quiz-option.correct {
        background: #d1e7dd;
        border-color: #198754;
        animation: pulse 0.5s;
      }

      .quiz-option.incorrect {
        background: #f8d7da;
        border-color: #dc3545;
        animation: shake 0.5s;
      }

      .quiz-option.disabled {
        pointer-events: none;
        opacity: 0.6;
      }

      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-12px); }
        75% { transform: translateX(12px); }
      }

      @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
      }

      .fade-transition {
        transition: opacity 0.3s ease-in-out;
      }

      .hidden {
        display: none !important;
      }

      .bottom-controls {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: blur(10px);
        border-top: 2px solid #e2e8f0;
        box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.08);
        padding: 12px 20px;
        z-index: 2000;
      }

      .control-row {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 40px;
        max-width: 800px;
        margin: 0 auto;
        flex-wrap: wrap;
      }

      .control-section {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .control-label {
        font-weight: 700;
        color: #475569;
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.8px;
        margin: 0;
        white-space: nowrap;
      }

      .radio-group {
        display: flex;
        gap: 12px;
      }

      .radio-option {
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .radio-option input[type="radio"] {
        width: 16px;
        height: 16px;
        cursor: pointer;
        accent-color: #3b82f6;
      }

      .radio-option.mode-option input[type="radio"] {
        accent-color: #10b981;
      }

      .radio-option label {
        font-size: 0.9rem;
        font-weight: 500;
        color: #334155;
        cursor: pointer;
        margin: 0;
        white-space: nowrap;
      }

      @media (max-width: 768px) {
        body {
          padding-bottom: 110px;
        }

        .abacus {
          gap: 8px;
        }
        
        .rod {
          width: 70px;
          height: 400px;
        }

        .rod-inner-label {
          font-size: 0.55rem;
          padding: 5px 3px;
        }

        .bead {
          width: 32px;
          height: 32px;
          margin-left: -16px;
        }
        
        #quizOptionsContainer {
          grid-template-columns: 1fr;
        }

        .quiz-option {
          font-size: 1.2rem;
          padding: 20px 15px;
        }

        .current-value-display {
          padding: 15px;
          max-width: 95%;
        }

        .current-value-display .value-number {
          font-size: 2rem;
        }

        .current-value-display .value-words {
          font-size: 1rem;
        }

        .bottom-controls {
          padding: 10px 15px;
        }

        .control-row {
          flex-direction: column;
          gap: 12px;
        }

        .control-label {
          font-size: 0.7rem;
        }

        .radio-option label {
          font-size: 0.85rem;
        }

        .radio-option input[type="radio"] {
          width: 14px;
          height: 14px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div id="abacusMode" class="fade-transition">
        <div class="abacus-container">
          <div class="abacus" id="abacus"></div>
          
          <div class="clear-button-container">
            <button class="clear-button" onclick="clearAbacus()" data-lang-key="clearButton">Clear Abacus</button>
          </div>
          
          <div class="current-value-display" id="currentValueDisplay">
            <div class="value-label" data-lang-key="currentValue">Current Value</div>
            <div class="value-number" id="currentValueNumber">0</div>
            <div class="value-words" id="currentValueWords">Zero</div>
          </div>
        </div>
      </div>

      <div id="quizMode" class="quiz-section hidden fade-transition">
        <h2 class="text-center mb-4" data-lang-key="quizTitle">Quick Contest</h2>
        
        <div class="quiz-question" id="quizQuestion"></div>
        
        <div id="quizOptionsContainer"></div>
        
        <div id="feedback" class="alert mt-4 hidden" role="alert"></div>
        
        <div class="text-center mt-4">
          <button id="newQuizBtn" class="btn btn-primary btn-lg" data-lang-key="newQuestion">New Question</button>
        </div>
      </div>
    </div>

    <div class="bottom-controls">
      <div class="control-row">
        <div class="control-section">
          <div class="control-label" data-lang-key="languageLabel">LANGUAGE</div>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" name="language" id="langEn" value="en" checked />
              <label for="langEn" data-lang-key="langEnglish">English</label>
            </div>
            <div class="radio-option">
              <input type="radio" name="language" id="langNe" value="ne" />
              <label for="langNe" data-lang-key="langNepali">Nepali</label>
            </div>
          </div>
        </div>
        
        <div class="control-section">
          <div class="control-label" data-lang-key="modeLabel">MODE</div>
          <div class="radio-group">
            <div class="radio-option mode-option">
              <input type="radio" name="mode" id="modeAbacus" value="abacus" checked />
              <label for="modeAbacus" data-lang-key="modeAbacus">Abacus Mode</label>
            </div>
            <div class="radio-option mode-option">
              <input type="radio" name="mode" id="modeQuiz" value="quiz" />
              <label for="modeQuiz" data-lang-key="modeQuiz">Quiz Mode</label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      let currentLanguage = "en";
      let currentMode = "abacus";

      const translations = {
        en: {
          langEnglish: "English",
          langNepali: "Nepali",
          languageLabel: "Language",
          modeLabel: "Mode",
          modeAbacus: "Abacus Mode",
          modeQuiz: "Quiz Mode",
          clearButton: "Clear Abacus",
          currentValue: "Current Value",
          quizTitle: "Quick Contest",
          newQuestion: "New Question",
          correctFeedback: "Correct! Watch the abacus animate...",
          incorrectFeedback: "Incorrect! Try again.",
          overflowAlert: "Overflow beyond highest place!",
          places: {
            crore: "Crore",
            tenLakh: "Ten Lakh",
            lakh: "Lakh",
            tenThousand: "Ten Thousand",
            thousand: "Thousand",
            hundred: "Hundred",
            ten: "Ten",
            one: "One"
          }
        },
        ne: {
          langEnglish: "अंग्रेजी",
          langNepali: "नेपाली",
          languageLabel: "भाषा",
          modeLabel: "मोड",
          modeAbacus: "अबेकस मोड",
          modeQuiz: "प्रश्नोत्तरी मोड",
          clearButton: "अबेकस खाली गर्नुहोस्",
          currentValue: "हालको मान",
          quizTitle: "द्रुत प्रतियोगिता",
          newQuestion: "नयाँ प्रश्न",
          correctFeedback: "सही! अबेकस एनिमेशन हेर्नुहोस्...",
          incorrectFeedback: "गलत! फेरि प्रयास गर्नुहोस्।",
          overflowAlert: "उच्चतम स्थान भन्दा बाहिर ओभरफ्लो!",
          places: {
            crore: "करोड",
            tenLakh: "दश लाख",
            lakh: "लाख",
            tenThousand: "दश हजार",
            thousand: "हजार",
            hundred: "सय",
            ten: "दश",
            one: "एक"
          }
        }
      };

      const quizPrompts = {
        en: "Represent {number} on the abacus",
        ne: "अबेकसमा {number} प्रतिनिधित्व गर्नुहोस्"
      };

      const places = [
        { key: "crore", value: 10000000, color: "#dc3545" },
        { key: "tenLakh", value: 1000000, color: "#28a745" },
        { key: "lakh", value: 100000, color: "#007bff" },
        { key: "tenThousand", value: 10000, color: "#6f42c1" },
        { key: "thousand", value: 1000, color: "#795548" },
        { key: "hundred", value: 100, color: "#fd7e14" },
        { key: "ten", value: 10, color: "#6610f2" },
        { key: "one", value: 1, color: "#20c997" },
      ];

      const abacus = document.getElementById("abacus");
      const currentValueDisplay = document.getElementById("currentValueDisplay");
      const currentValueNumber = document.getElementById("currentValueNumber");
      const currentValueWords = document.getElementById("currentValueWords");

      let counts = new Array(places.length).fill(0);
      let beadElements = [];
      let labelElements = [];
      let isAnimating = false;

      function numberToWordsEn(num) {
        if (num === 0) return "Zero";
        const a = ["", "One", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine",
          "Ten", "Eleven", "Twelve", "Thirteen", "Fourteen", "Fifteen", "Sixteen",
          "Seventeen", "Eighteen", "Nineteen"];
        const b = ["", "", "Twenty", "Thirty", "Forty", "Fifty", "Sixty", "Seventy", "Eighty", "Ninety"];
        function inWords(n) {
          if (n < 20) return a[n];
          if (n < 100) return b[Math.floor(n / 10)] + (n % 10 ? " " + a[n % 10] : "");
          if (n < 1000) return a[Math.floor(n / 100)] + " Hundred" + (n % 100 ? " " + inWords(n % 100) : "");
          if (n < 100000) return inWords(Math.floor(n / 1000)) + " Thousand" + (n % 1000 ? " " + inWords(n % 1000) : "");
          if (n < 10000000) return inWords(Math.floor(n / 100000)) + " Lakh" + (n % 100000 ? " " + inWords(n % 100000) : "");
          return inWords(Math.floor(n / 10000000)) + " Crore" + (n % 10000000 ? " " + inWords(n % 10000000) : "");
        }
        return inWords(num);
      }

      function numberToWordsNe(num) {
        if (num === 0) return "शून्य";
        const a = ["", "एक", "दुई", "तीन", "चार", "पाँच", "छ", "सात", "आठ", "नौ",
          "दश", "एघार", "बाह्र", "तेह्र", "चौध", "पन्ध्र", "सोह्र", "सत्र", "अठार", "उन्नाइस"];
        const b = ["", "", "बीस", "तीस", "चालीस", "पचास", "साठी", "सत्तरी", "अस्सी", "नब्बे"];
        function inWords(n) {
          if (n < 20) return a[n];
          if (n < 100) return b[Math.floor(n / 10)] + (n % 10 ? " " + a[n % 10] : "");
          if (n < 1000) return a[Math.floor(n / 100)] + " सय" + (n % 100 ? " " + inWords(n % 100) : "");
          if (n < 100000) return inWords(Math.floor(n / 1000)) + " हजार" + (n % 1000 ? " " + inWords(n % 1000) : "");
          if (n < 10000000) return inWords(Math.floor(n / 100000)) + " लाख" + (n % 100000 ? " " + inWords(n % 100000) : "");
          return inWords(Math.floor(n / 10000000)) + " करोड" + (n % 10000000 ? " " + inWords(n % 10000000) : "");
        }
        return inWords(num);
      }

      function numberToWords(num) {
        return currentLanguage === "en" ? numberToWordsEn(num) : numberToWordsNe(num);
      }

      function formatNumber(num, lang) {
        if (lang === "ne") {
          const nepaliDigits = ['०', '१', '२', '३', '४', '५', '६', '७', '८', '९'];
          return num.toLocaleString("en-IN").split('').map(char => {
            return /\d/.test(char) ? nepaliDigits[parseInt(char)] : char;
          }).join('');
        }
        return num.toLocaleString("en-IN");
      }

      places.forEach((p, idx) => {
        const rodContainer = document.createElement("div");
        rodContainer.className = "rod-container";

        const rod = document.createElement("div");
        rod.className = "rod";
        rod.style.cursor = "pointer";
        rod.addEventListener("click", () => dropBead(idx));

        const innerLabel = document.createElement("div");
        innerLabel.className = "rod-inner-label";
        innerLabel.style.background = p.color;
        labelElements.push({ element: innerLabel, key: p.key });
        rod.appendChild(innerLabel);

        const beadsForRod = [];
        for (let i = 0; i < 9; i++) {
          const bead = document.createElement("div");
          bead.className = "bead";
          bead.style.background = `radial-gradient(circle at 30% 30%, ${p.color}, ${p.color}dd)`;
          rod.appendChild(bead);
          beadsForRod.push(bead);
        }
        beadElements.push(beadsForRod);

        rodContainer.appendChild(rod);
        abacus.appendChild(rodContainer);
      });

      function dropBead(idx) {
        if (isAnimating) return;
        counts[idx]++;
        if (counts[idx] <= 9) {
          animateBead(idx, counts[idx]);
        } else {
          flashOverflow(idx);
          counts[idx] = 0;
          animateBead(idx, counts[idx]);
          if (idx > 0) {
            dropBead(idx - 1);
          } else {
            alert(translations[currentLanguage].overflowAlert);
          }
        }
        // Update and show the current value display
        updateCurrentValue();
      }

      function updateCurrentValue() {
        let total = 0;
        counts.forEach((c, idx) => {
          total += c * places[idx].value;
        });
        currentValueNumber.textContent = formatNumber(total, currentLanguage);
        currentValueWords.textContent = numberToWords(total);
        
        // Show the display if there's any value
        if (total > 0) {
          currentValueDisplay.classList.add('visible');
        } else {
          currentValueDisplay.classList.remove('visible');
        }
      }

      function animateBead(idx, count) {
        const beads = beadElements[idx];
        const spacing = 50;
        const rodHeight = 480;
        const rodBottomOffset = 45;
        const topOffset = 50;
        beads.forEach((b, i) => {
          if (i < count) {
            b.style.top = `${rodHeight - rodBottomOffset - (i + 1) * spacing}px`;
          } else {
            b.style.top = `-60px`;
          }
        });
      }

      function flashOverflow(idx) {
        const rods = document.querySelectorAll(".rod");
        rods[idx].classList.add("overflow");
        setTimeout(() => rods[idx].classList.remove("overflow"), 500);
      }

      async function clearAbacus() {
        if (isAnimating) return;
        isAnimating = true;
        
        // Hide the value display when clearing
        currentValueDisplay.classList.remove('visible');
        
        counts.fill(0);
        for (let idx = places.length - 1; idx >= 0; idx--) {
          animateBead(idx, 0);
          await new Promise(resolve => setTimeout(resolve, 80));
        }
        isAnimating = false;
      }

      function updateLanguage() {
        document.querySelectorAll("[data-lang-key]").forEach(el => {
          const key = el.getAttribute("data-lang-key");
          if (translations[currentLanguage][key]) {
            el.textContent = translations[currentLanguage][key];
          }
        });
        labelElements.forEach(lbl => {
          lbl.element.textContent = translations[currentLanguage].places[lbl.key];
        });
        if (currentMode === "quiz") {
          generateQuiz();
        }
      }

      function switchMode() {
        const abacusMode = document.getElementById("abacusMode");
        const quizMode = document.getElementById("quizMode");
        if (currentMode === "abacus") {
          abacusMode.classList.remove("hidden");
          quizMode.classList.add("hidden");
        } else {
          abacusMode.classList.add("hidden");
          quizMode.classList.remove("hidden");
          generateQuiz();
        }
      }

      document.querySelectorAll('input[name="language"]').forEach(radio => {
        radio.addEventListener("change", (e) => {
          currentLanguage = e.target.value;
          updateLanguage();
        });
      });

      document.querySelectorAll('input[name="mode"]').forEach(radio => {
        radio.addEventListener("change", (e) => {
          currentMode = e.target.value;
          switchMode();
        });
      });

      let currentQuizAnswer = 0;
      let quizOptions = [];

      function generateQuiz() {
        const max = 9999999;
        const min = 1000;
        currentQuizAnswer = Math.floor(Math.random() * (max - min + 1)) + min;
        const questionLang = currentLanguage;
        const questionNumberLang = currentLanguage;
        const optionNumberLang = currentLanguage === "en" ? "ne" : "en";
        const formattedNumber = formatNumber(currentQuizAnswer, questionNumberLang);
        const question = quizPrompts[questionLang].replace("{number}", formattedNumber);
        document.getElementById("quizQuestion").textContent = question;
        quizOptions = [currentQuizAnswer];
        while (quizOptions.length < 4) {
          const offset = Math.floor(Math.random() * 100000) - 50000;
          const option = Math.max(min, Math.min(max, currentQuizAnswer + offset));
          if (!quizOptions.includes(option)) {
            quizOptions.push(option);
          }
        }
        quizOptions.sort(() => Math.random() - 0.5);
        const optionsContainer = document.getElementById("quizOptionsContainer");
        optionsContainer.innerHTML = "";
        quizOptions.forEach(option => {
          const optionDiv = document.createElement("div");
          optionDiv.className = "quiz-option";
          optionDiv.textContent = formatNumber(option, optionNumberLang);
          optionDiv.addEventListener("click", () => checkAnswer(option, optionDiv));
          optionsContainer.appendChild(optionDiv);
        });
        const feedback = document.getElementById("feedback");
        feedback.classList.add("hidden");
        feedback.textContent = "";
      }

      async function checkAnswer(selected, btnElement) {
        const allOptions = document.querySelectorAll(".quiz-option");
        allOptions.forEach(opt => opt.classList.add("disabled"));
        if (selected === currentQuizAnswer) {
          btnElement.classList.add("correct");
          const feedback = document.getElementById("feedback");
          feedback.textContent = translations[currentLanguage].correctFeedback;
          feedback.className = "alert alert-success";
          feedback.classList.remove("hidden");
          await new Promise(resolve => setTimeout(resolve, 1500));
          document.getElementById("modeAbacus").checked = true;
          currentMode = "abacus";
          switchMode();
          await new Promise(resolve => setTimeout(resolve, 300));
          await animateAbacusToNumber(currentQuizAnswer);
        } else {
          btnElement.classList.add("incorrect");
          const feedback = document.getElementById("feedback");
          feedback.textContent = translations[currentLanguage].incorrectFeedback;
          feedback.className = "alert alert-danger";
          feedback.classList.remove("hidden");
          setTimeout(() => {
            btnElement.classList.remove("incorrect");
            allOptions.forEach(opt => opt.classList.remove("disabled"));
            feedback.classList.add("hidden");
          }, 1500);
        }
      }

      async function animateAbacusToNumber(num) {
        isAnimating = true;
        currentValueDisplay.classList.add('visible');
        counts.fill(0);
        counts.forEach((_, idx) => animateBead(idx, 0));
        currentValueNumber.textContent = formatNumber(0, currentLanguage);
        currentValueWords.textContent = numberToWords(0);
        await new Promise(resolve => setTimeout(resolve, 400));
        const digits = [];
        let remaining = num;
        for (let i = 0; i < places.length; i++) {
          const digit = Math.floor(remaining / places[i].value);
          digits.push(digit);
          remaining -= digit * places[i].value;
        }
        for (let i = 0; i < places.length; i++) {
          if (digits[i] > 0) {
            counts[i] = digits[i];
            animateBead(i, digits[i]);
            let currentTotal = 0;
            counts.forEach((c, idx) => {
              currentTotal += c * places[idx].value;
            });
            currentValueNumber.textContent = formatNumber(currentTotal, currentLanguage);
            currentValueWords.textContent = numberToWords(currentTotal);
            await new Promise(resolve => setTimeout(resolve, 450));
          }
        }
        // Keep the display visible - don't hide it automatically
        isAnimating = false;
      }

      document.getElementById("newQuizBtn").addEventListener("click", () => {
        counts.fill(0);
        counts.forEach((_, idx) => animateBead(idx, 0));
        generateQuiz();
      });

      updateLanguage();
    </script>
  </body>
</html>